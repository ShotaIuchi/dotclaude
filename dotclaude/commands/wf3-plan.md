# /wf3-plan

å®Ÿè£…è¨ˆç”»ï¼ˆPlanï¼‰ã‚’ä½œæˆã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã€‚

## ä½¿ç”¨æ–¹æ³•

```
/wf3-plan [ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰]
```

## ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰

- `(ãªã—)`: æ–°è¦ä½œæˆ
- `update`: æ—¢å­˜ã® Plan ã‚’æ›´æ–°
- `step <n>`: ç‰¹å®šã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°ã‚’è¡¨ç¤º

## å‡¦ç†å†…å®¹

$ARGUMENTS ã‚’è§£æã—ã¦ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### 1. å‰ææ¡ä»¶ã®ç¢ºèª

```bash
work_id=$(jq -r '.active_work // empty' .wf/state.json)
docs_dir="docs/wf/$work_id"
kickoff_path="$docs_dir/00_KICKOFF.md"
spec_path="$docs_dir/01_SPEC.md"
plan_path="$docs_dir/02_PLAN.md"

# Spec ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
if [ ! -f "$spec_path" ]; then
  echo "Spec ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“"
  echo "/wf2-spec ã‚’å…ˆã«å®Ÿè¡Œã—ã¦ãã ã•ã„"
  exit 1
fi
```

### 2. Spec ã®èª­ã¿è¾¼ã¿ã¨åˆ†æ

```bash
cat "$spec_path"
```

Spec ã‹ã‚‰ä»¥ä¸‹ã‚’æŠ½å‡ºï¼š
- Affected Components
- Detailed Changes
- Test Strategy

### 3. ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®è©³ç´°èª¿æŸ»

å®Ÿè£…ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ï¼š

1. **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å®š**
   - å¤‰æ›´ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«
   - æ–°è¦ä½œæˆãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«
   - ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

2. **ä¾å­˜é–¢ä¿‚ã®åˆ†æ**
   - ãƒ•ã‚¡ã‚¤ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚
   - å¤‰æ›´ã®é †åºã®æ±ºå®š

3. **ãƒªã‚¹ã‚¯è©•ä¾¡**
   - è¤‡é›‘ãªå¤‰æ›´ç®‡æ‰€
   - å‰¯ä½œç”¨ã®å¯èƒ½æ€§

### 4. ã‚¹ãƒ†ãƒƒãƒ—åˆ†å‰²ã®åŸå‰‡

ä»¥ä¸‹ã®åŸå‰‡ã«å¾“ã£ã¦ã‚¹ãƒ†ãƒƒãƒ—ã‚’åˆ†å‰²ï¼š

1. **1ã‚¹ãƒ†ãƒƒãƒ— = 1å›ã® /wf5-implement**
   - 1å›ã®å®Ÿè£…ã§å®Œäº†ã§ãã‚‹ç¯„å›²
   - ã‚³ãƒŸãƒƒãƒˆå˜ä½ã¨ã—ã¦é©åˆ‡ãªã‚µã‚¤ã‚º

2. **ä¾å­˜é †åºã‚’è€ƒæ…®**
   - åŸºç›¤ã¨ãªã‚‹å¤‰æ›´ã‚’å…ˆã«
   - ãƒ†ã‚¹ãƒˆã¯å®Ÿè£…ã¨åŒæ™‚ã¾ãŸã¯ç›´å¾Œ

3. **ãƒªã‚¹ã‚¯åˆ†æ•£**
   - è¤‡é›‘ãªå¤‰æ›´ã¯åˆ†å‰²
   - ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ã‚„ã™ã„å˜ä½

### 5. Plan ã®ä½œæˆ

**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå‚ç…§:** `~/.claude/templates/02_PLAN.md` ã‚’èª­ã¿è¾¼ã‚“ã§ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã‚’èª¿æŸ»çµæœã¨ Spec ã®å†…å®¹ã§ç½®æ›ã—ã¾ã™ã€‚

**æ³¨æ„:** ã‚¹ãƒ†ãƒƒãƒ—ã¯5-10å€‹ç¨‹åº¦ã«åˆ†å‰²ã—ã€02_PLAN.md ã® Step ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¿…è¦æ•°ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚
Progress ãƒ†ãƒ¼ãƒ–ãƒ«ã‚‚åŒæ§˜ã«ã‚¹ãƒ†ãƒƒãƒ—æ•°ã«å¿œã˜ã¦è¡Œã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

### 6. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®ç¢ºèª

Plan ã‚’ä½œæˆå¾Œã€ä»¥ä¸‹ã‚’ç¢ºèªï¼š

1. **ã‚¹ãƒ†ãƒƒãƒ—æ•°ã®å¦¥å½“æ€§**
   - å¤šã™ããªã„ã‹ï¼ˆç›®å®‰: 5-10ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
   - ç²’åº¦ã¯é©åˆ‡ã‹

2. **ä¾å­˜é–¢ä¿‚**
   - é †åºã¯æ­£ã—ã„ã‹
   - ä¸¦è¡Œå®Ÿè¡Œå¯èƒ½ãªã‚¹ãƒ†ãƒƒãƒ—ã¯ã‚ã‚‹ã‹

3. **ãƒªã‚¹ã‚¯è©•ä¾¡**
   - è¦‹è½ã¨ã—ã¦ã„ã‚‹ãƒªã‚¹ã‚¯ã¯ãªã„ã‹

### 7. state.json ã®æ›´æ–°

```bash
jq ".works[\"$work_id\"].current = \"wf3-plan\"" .wf/state.json > tmp && mv tmp .wf/state.json
jq ".works[\"$work_id\"].next = \"wf4-review\"" .wf/state.json > tmp && mv tmp .wf/state.json

# ã‚¹ãƒ†ãƒƒãƒ—æƒ…å ±ã‚’è¿½åŠ 
jq ".works[\"$work_id\"].plan = {\"total_steps\": <n>, \"current_step\": 0, \"steps\": {}}" .wf/state.json > tmp && mv tmp .wf/state.json
```

### 8. ã‚³ãƒŸãƒƒãƒˆ

Plan ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆï¼š

```bash
# æ–°è¦ä½œæˆã®å ´åˆ
git add "$plan_path" .wf/state.json
git commit -m "docs(wf): create plan <work-id>

Steps: <n>
Work: <work-id>
"

# update ã®å ´åˆ
git add "$plan_path" .wf/state.json
git commit -m "docs(wf): update plan <work-id>

Steps: <n>
Work: <work-id>
"
```

### 9. å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```
âœ… Plan ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ

ãƒ•ã‚¡ã‚¤ãƒ«: docs/wf/<work-id>/02_PLAN.md

Implementation Steps:
1. <step1_title> (small)
2. <step2_title> (medium)
3. <step3_title> (small)

Total: 3 steps

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:
- ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå¿…è¦ãªå ´åˆ: /wf4-review
- å®Ÿè£…ã‚’é–‹å§‹ã™ã‚‹å ´åˆ: /wf5-implement
```

## step ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰

ç‰¹å®šã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°ã‚’è¡¨ç¤ºï¼š

```
/wf3-plan step 1
```

å‡ºåŠ›ï¼š
```
ğŸ“‹ Step 1: <title>
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç›®çš„: <goal>

å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:
- <file1>
- <file2>

ä½œæ¥­å†…å®¹:
1. <task1>
2. <task2>

å®Œäº†æ¡ä»¶:
- [ ] <condition1>
- [ ] <condition2>

è¦‹ç©ã‚‚ã‚Š: medium
ä¾å­˜: ãªã—
```

## æ³¨æ„äº‹é …

- Spec ã®å†…å®¹ã‚’è¶…ãˆã‚‹å¤‰æ›´ã‚’ Plan ã«å«ã‚ãªã„
- å®Ÿè£…é †åºã¯ä¾å­˜é–¢ä¿‚ã‚’å³å¯†ã«è€ƒæ…®
- å„ã‚¹ãƒ†ãƒƒãƒ—ã¯å˜ç‹¬ã§ãƒ†ã‚¹ãƒˆå¯èƒ½ãªå˜ä½ã«
