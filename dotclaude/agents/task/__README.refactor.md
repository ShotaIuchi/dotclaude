# Review: refactor.md

> Reviewed: 2026-01-22
> Original: dotclaude/agents/task/refactor.md

## 概要 (Summary)

このドキュメントは、コードリファクタリング提案を行うエージェント「refactor」の定義ファイルです。コードの品質、可読性、保守性を向上させるための変更を、動作を変えずに提案することを目的としています。入力パラメータ、検出可能なコードスメル、リファクタリングパターン、および出力フォーマットが詳細に定義されています。

## 評価 (Evaluation)

### 品質 (Quality)

- [x] **完全性 (Completeness)**: 必要な情報が網羅されている
- [x] **明確性 (Clarity)**: 読者にとって分かりやすい
- [x] **一貫性 (Consistency)**: 用語・スタイルが統一されている

### 技術的正確性 (Technical Accuracy)

- [x] **情報の正確性 (Correct information)**: 記載内容が正確
- [ ] **最新性 (Up-to-date content)**: 情報が最新の状態

## 改善点 (Improvements)

### 優先度高 (High Priority)

| # | 箇所 | 問題 | 提案 | Status |
|---|------|------|------|--------|
| 1 | Instructions セクション | bashコマンドで `cat` を使用している | Claude Codeでは `cat` の代わりに Read ツールを使用する指示に変更すべき | ✓ Fixed (2026-01-22) |
| 2 | Instructions セクション | `cat *${target_name}*.test.ts` はglobパターンの動作が不安定 | Glob ツールを使用してテストファイルを検索する方法に変更すべき | ✓ Fixed (2026-01-22) |

### 優先度中 (Medium Priority)

| # | 箇所 | 問題 | 提案 | Status |
|---|------|------|------|--------|
| 1 | Metadata | Base Type が "plan" となっているが、実際にはコード分析を行うため "explore" が適切では | 他のエージェント（reviewer）との一貫性を考慮し、Base Type の見直しを検討 | ✓ Fixed (2026-01-22) |
| 2 | Output Format | TypeScript固定の例示 | 言語に依存しない例示、または複数言語の例を追加 | ✓ Fixed (2026-01-22) |
| 3 | Capabilities | 「Impact Analysis」の説明が簡素 | 具体的な分析手法や出力例を追加 | ✓ Fixed (2026-01-22) |

### 将来の検討事項 (Future Considerations)

- **多言語対応**: 現在TypeScript中心の例示となっているが、Python、Go、Rustなど他の言語への対応例を追加することで汎用性が向上 ✓ Fixed (2026-01-22)
- **自動化連携**: リファクタリング提案を自動的に適用するワークフローとの連携方法の記載
- **メトリクス定義**: 循環的複雑度の目標値など、具体的な閾値の定義
- **テスト連携**: リファクタリング後のテスト実行・検証に関するガイダンス

## 総評 (Overall Assessment)

refactor.md は、リファクタリングエージェントの役割と機能を明確に定義した良質なドキュメントです。構成は reviewer.md などの他のタスクエージェントと一貫しており、プロジェクト全体のドキュメント規約に準拠しています。

**強み:**
- コードスメルの分類が体系的で分かりやすい
- リファクタリングパターンと問題のマッピングが明確
- 出力フォーマットが詳細で、実用的なテンプレートとして機能
- 優先度決定の基準（Impact、Risk、Effort）が明示されている

**改善すべき点:**
- bashコマンド（cat）を使用している箇所があり、Claude Codeの推奨ツール（Read、Glob）への移行が必要
- 言語固有の例示が多く、汎用性に欠ける部分がある

全体として、本ドキュメントは実用に耐える完成度を持っていますが、上記の優先度高の改善点を対応することで、より堅牢なエージェント定義となります。
